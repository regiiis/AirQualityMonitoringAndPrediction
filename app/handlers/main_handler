

def handler(event, context):
    """
    Main handler function to validate and store the incoming data.
    """
    # Parse the incoming event
    body = json.loads(event) if isinstance(event, str) else event

    # Validate the incoming data
    validation_result = data_validator(body)

    if not validation_result["valid"]:
        return format_response(400, {"error": validation_result["error"], "message": validation_result["message"]})

    # If valid, proceed to store the data in S3
    storage_result = data_storer.handler(body, context)

    return storage_result
